#!/bin/sh
#set -x
echo "Surface-wave Dispersion Semi-Analitical Modelling"
echo "using CPS; Herrmann, 2002" 
echo "L. Bodet 2005/2006 -- LCPC/BRGM "
echo "deplacements"
#please cf. CPS documentation for details

#Model Name
name=2layers_orig_new



cat > dfile << EOF
0.001 1.25e-3 10000 0.0 0.0


EOF

cat > $name.model.d << EOF
MODEL
TEST MODEL
ISOTROPIC
KGS
FLAT EARTH
2-D
CONSTANT VELOCITY
LINE08
LINE09
LINE10
LINE11
HR      VP      VS     RHO QP  QS  ETAP ETAS FREFP FREFS
0.001 0.6 0.3464101615137755 0.001558  0 0 0 0 1 1
0.001 0.78325 0.4522095983427744 0.00158  0 0 0 0 1 1
0.001 0.9665 0.5580090351717734 0.001659  0 0 0 0 1 1
0.001 1.14975 0.6638084720007722 0.001764  0 0 0 0 1 1
0.001 1.333 0.7696079088297711 0.001865  0 0 0 0 1 1
0.001 1.51625 0.8754073456587702 0.001958  0 0 0 0 1 1
0.001 1.6995 0.981206782487769 0.002085  0 0 0 0 1 1
0.001 1.88275 1.087006219316768 0.002191  0 0 0 0 1 1
0.001 2.066 1.192805656145767 0.002253  0 0 0 0 1 1
0.001 2.24925 1.2986050929747657 0.002295  0 0 0 0 1 1
0.001 1.4985032138477088 0.0 0.001001292  0 0 0 0 1 1
0.001 1.4985032138477088 0.0 0.001001292  0 0 0 0 1 1
0.001 1.4985032138477088 0.0 0.001001292  0 0 0 0 1 1
0.001 2.98225 1.7218028402907615 0.002377  0 0 0 0 1 1
0.001 3.1655 1.8276022771197604 0.002393  0 0 0 0 1 1
0.001 3.34875 1.9334017139487594 0.002411  0 0 0 0 1 1
0.001 3.532 2.0392011507777585 0.002424  0 0 0 0 1 1
0.001 3.5745454545454547 2.063764780412371 0.002435  0 0 0 0 1 1
0.001 3.617090909090909 2.0883284100469846 0.002445  0 0 0 0 1 1
0.001 3.6596363636363636 2.112892039681598 0.002451  0 0 0 0 1 1
0.001 3.702181818181818 2.137455669316211 0.002457  0 0 0 0 1 1
0.001 3.7447272727272725 2.162019298950824 0.002464  0 0 0 0 1 1
0.001 3.787272727272727 2.186582928585437 0.002475  0 0 0 0 1 1
0.001 3.829818181818182 2.211146558220051 0.002487  0 0 0 0 1 1
0.001 3.8723636363636365 2.2357101878546635 0.002488  0 0 0 0 1 1
0.001 3.914909090909091 2.260273817489277 0.002473  0 0 0 0 1 1
0.001 3.9574545454545453 2.28483744712389 0.002456  0 0 0 0 1 1
0.001 4.0 2.3094010767585034 0.002449  0 0 0 0 1 1
0.00000000      1.20000      0.690000      2.00000   0.000000    0.000000       0.0000000       0.00000000       1.00000000       1.00000000#####################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ########################################################################### 
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ########################################################################### 
   ###########################################################################
   ###########################################################################
   ########################################################################### 
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################
   ###########################################################################      
EOF



 ################
#sprep96 -M $name.model.d -NMOD ${NMODE} -R  -d dfile 
sprep96 -M $name.model.d -NMOD 6 -R  -d dfile 
sdisp96
#sdisp96 -M $name.model.d -NMOD 3 -R  -d dfile 

sdpsrf96 -R -FREQ -TXT
cp SDISPR.TXT $name.txt
cp SDISPR.TXT $name.rc.dat

# cat > $name.roland.plot << EOF
# set term X11
# #set term postscript 
# #set output "$name.tdspdep.ps"
# set xlabel "frequency (Hz)"
# set ylabel "velocity (m/s)"
# set yrange [0. : 750.]
# set xrange [0. : 250.]
# plot '$name.rc.dat' us (\$2):(1000*\$3) w l #with lines
# EOF
# gnuplot< $name.roland.plot



#rm -rf sdisp96.dat sdisp96.lov sdisp96.ray slegn96.egn sregn96.egn \
#       SLEGNC.PLT SREGNC.PLT dfile slegn96.der sregn96.der \
#       SDISPR.PLT \
#       SRDER.PLT \
#       *.TXT
##       SRDER.TXT
